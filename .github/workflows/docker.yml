name: 'ğŸ‹ docker'

on:
  push:
    branches: [ "main" ]
  pull_request:
    branches: [ "main" ]

jobs:

  build-and-push:

    runs-on: ubuntu-latest

    steps:
    
    # ğŸ¶ orchestrator
    - uses: actions/checkout@v4
    - name: 'ğŸ‹ build Docker image'
      working-directory: ./src/orchestrator
      run: docker build -t ${{ vars.DOCKER_HUB_USERNAME }}/emoji-api-orchestrator .

    - name: 'ğŸ‹ log in to Docker Hub'
      run: echo ${{ secrets.DOCKER_HUB_TOKEN }} | docker login -u ${{ vars.DOCKER_HUB_USERNAME }} --password-stdin      
      
    - name: 'ğŸ‹ push image to Docker Hub'
      run: docker push ${{ vars.DOCKER_HUB_USERNAME }}/emoji-api-orchestrator

    # ğŸ’ animals
    - uses: actions/checkout@v4
    - name: 'ğŸ‹ build Docker image'
      working-directory: ./src/animals
      run: docker build -t ${{ vars.DOCKER_HUB_USERNAME }}/emoji-api-animals .

    - name: 'ğŸ‹ log in to Docker Hub'
      run: echo ${{ secrets.DOCKER_HUB_TOKEN }} | docker login -u ${{ vars.DOCKER_HUB_USERNAME }} --password-stdin      
      
    - name: 'ğŸ‹ push image to Docker Hub'
      run: docker push ${{ vars.DOCKER_HUB_USERNAME }}/emoji-api-animals


    # ğŸ” foods
    - uses: actions/checkout@v4
    - name: 'ğŸ‹ build Docker image'
      working-directory: ./src/foods
      run: docker build -t ${{ vars.DOCKER_HUB_USERNAME }}/emoji-api-foods .

    - name: 'ğŸ‹ log in to Docker Hub'
      run: echo ${{ secrets.DOCKER_HUB_TOKEN }} | docker login -u ${{ vars.DOCKER_HUB_USERNAME }} --password-stdin      
      
    - name: 'ğŸ‹ push image to Docker Hub'
      run: docker push ${{ vars.DOCKER_HUB_USERNAME }}/emoji-api-foods


    # ğŸˆ sports
    - uses: actions/checkout@v4
    - name: 'ğŸ‹ build Docker image'
      working-directory: ./src/sports
      run: docker build -t ${{ vars.DOCKER_HUB_USERNAME }}/emoji-api-sports .

    - name: 'ğŸ‹ log in to Docker Hub'
      run: echo ${{ secrets.DOCKER_HUB_TOKEN }} | docker login -u ${{ vars.DOCKER_HUB_USERNAME }} --password-stdin      
      
    - name: 'ğŸ‹ push image to Docker Hub'
      run: docker push ${{ vars.DOCKER_HUB_USERNAME }}/emoji-api-sports      
